(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{4534:()=>{},7842:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>y});var r=i(5155),n=i(2115),a=Object.defineProperty,o=(e,t,i)=>t in e?a(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,h=(e,t,i)=>o(e,"symbol"!=typeof t?t+"":t,i);let s={x:0,y:0,width:0,height:0,unit:"px"},d=(e,t,i)=>Math.min(Math.max(e,t),i),l=(...e)=>e.filter(e=>e&&"string"==typeof e).join(" "),c=(e,t)=>e===t||e.width===t.width&&e.height===t.height&&e.x===t.x&&e.y===t.y&&e.unit===t.unit;function g(e,t,i){return"%"===e.unit?{...s,...e,unit:"%"}:{unit:"%",x:e.x?e.x/t*100:0,y:e.y?e.y/i*100:0,width:e.width?e.width/t*100:0,height:e.height?e.height/i*100:0}}function w(e,t,i){return e.unit?"px"===e.unit?{...s,...e,unit:"px"}:{unit:"px",x:e.x?e.x*t/100:0,y:e.y?e.y*i/100:0,width:e.width?e.width*t/100:0,height:e.height?e.height*i/100:0}:{...s,...e,unit:"px"}}function p(e,t,i,r,n,a=0,o=0,h=r,s=n){let d={...e},l=Math.min(a,r),c=Math.min(o,n),g=Math.min(h,r),w=Math.min(s,n);t&&(t>1?(c=(l=o?o*t:l)/t,g=h*t):(l=(c=a?a/t:c)*t,w=s/t)),d.y<0&&(d.height=Math.max(d.height+d.y,c),d.y=0),d.x<0&&(d.width=Math.max(d.width+d.x,l),d.x=0);let u=r-(d.x+d.width);u<0&&(d.x=Math.min(d.x,r-l),d.width+=u);let m=n-(d.y+d.height);if(m<0&&(d.y=Math.min(d.y,n-c),d.height+=m),d.width<l&&(("sw"===i||"nw"==i)&&(d.x-=l-d.width),d.width=l),d.height<c&&(("nw"===i||"ne"==i)&&(d.y-=c-d.height),d.height=c),d.width>g&&(("sw"===i||"nw"==i)&&(d.x-=g-d.width),d.width=g),d.height>w&&(("nw"===i||"ne"==i)&&(d.y-=w-d.height),d.height=w),t){let e=d.width/d.height;if(e<t){let e=Math.max(d.width/t,c);("nw"===i||"ne"==i)&&(d.y-=e-d.height),d.height=e}else if(e>t){let e=Math.max(d.height*t,l);("sw"===i||"nw"==i)&&(d.x-=e-d.width),d.width=e}}return d}let u={capture:!0,passive:!1},m=0,x=class e extends n.PureComponent{constructor(){super(...arguments),h(this,"docMoveBound",!1),h(this,"mouseDownOnCrop",!1),h(this,"dragStarted",!1),h(this,"evData",{startClientX:0,startClientY:0,startCropX:0,startCropY:0,clientX:0,clientY:0,isResize:!0}),h(this,"componentRef",(0,n.createRef)()),h(this,"mediaRef",(0,n.createRef)()),h(this,"resizeObserver"),h(this,"initChangeCalled",!1),h(this,"instanceId",`rc-${m++}`),h(this,"state",{cropIsActive:!1,newCropIsBeingDrawn:!1}),h(this,"onCropPointerDown",e=>{let{crop:t,disabled:i}=this.props,r=this.getBox();if(!t)return;let n=w(t,r.width,r.height);if(i)return;e.cancelable&&e.preventDefault(),this.bindDocMove(),this.componentRef.current.focus({preventScroll:!0});let a=e.target.dataset.ord,o=e.clientX,h=e.clientY,s=n.x,d=n.y;if(a){let t=e.clientX-r.x,i=e.clientY-r.y,l=0,c=0;"ne"===a||"e"==a?(l=t-(n.x+n.width),c=i-n.y,s=n.x,d=n.y+n.height):"se"===a||"s"===a?(l=t-(n.x+n.width),c=i-(n.y+n.height),s=n.x,d=n.y):"sw"===a||"w"==a?(l=t-n.x,c=i-(n.y+n.height),s=n.x+n.width,d=n.y):("nw"===a||"n"==a)&&(l=t-n.x,c=i-n.y,s=n.x+n.width,d=n.y+n.height),o=s+r.x+l,h=d+r.y+c}this.evData={startClientX:o,startClientY:h,startCropX:s,startCropY:d,clientX:e.clientX,clientY:e.clientY,isResize:!!a,ord:a},this.mouseDownOnCrop=!0,this.setState({cropIsActive:!0})}),h(this,"onComponentPointerDown",e=>{let{crop:t,disabled:i,locked:r,keepSelection:n,onChange:a}=this.props,o=this.getBox();if(i||r||n&&t)return;e.cancelable&&e.preventDefault(),this.bindDocMove(),this.componentRef.current.focus({preventScroll:!0});let h=e.clientX-o.x,s=e.clientY-o.y,d={unit:"px",x:h,y:s,width:0,height:0};this.evData={startClientX:e.clientX,startClientY:e.clientY,startCropX:h,startCropY:s,clientX:e.clientX,clientY:e.clientY,isResize:!0},this.mouseDownOnCrop=!0,a(w(d,o.width,o.height),g(d,o.width,o.height)),this.setState({cropIsActive:!0,newCropIsBeingDrawn:!0})}),h(this,"onDocPointerMove",e=>{let t,{crop:i,disabled:r,onChange:n,onDragStart:a}=this.props,o=this.getBox();if(r||!i||!this.mouseDownOnCrop)return;e.cancelable&&e.preventDefault(),this.dragStarted||(this.dragStarted=!0,a&&a(e));let{evData:h}=this;h.clientX=e.clientX,h.clientY=e.clientY,c(i,t=h.isResize?this.resizeCrop():this.dragCrop())||n(w(t,o.width,o.height),g(t,o.width,o.height))}),h(this,"onComponentKeyDown",t=>{let{crop:i,disabled:r,onChange:n,onComplete:a}=this.props;if(r)return;let o=t.key,h=!1;if(!i)return;let s=this.getBox(),l=this.makePixelCrop(s),c=(navigator.platform.match("Mac")?t.metaKey:t.ctrlKey)?e.nudgeStepLarge:t.shiftKey?e.nudgeStepMedium:e.nudgeStep;if("ArrowLeft"===o?(l.x-=c,h=!0):"ArrowRight"===o?(l.x+=c,h=!0):"ArrowUp"===o?(l.y-=c,h=!0):"ArrowDown"===o&&(l.y+=c,h=!0),h){t.cancelable&&t.preventDefault(),l.x=d(l.x,0,s.width-l.width),l.y=d(l.y,0,s.height-l.height);let e=w(l,s.width,s.height),i=g(l,s.width,s.height);n(e,i),a&&a(e,i)}}),h(this,"onHandlerKeyDown",(t,i)=>{let{aspect:r=0,crop:n,disabled:a,minWidth:o=0,minHeight:h=0,maxWidth:s,maxHeight:d,onChange:l,onComplete:u}=this.props,m=this.getBox();if(a||!n||"ArrowUp"!==t.key&&"ArrowDown"!==t.key&&"ArrowLeft"!==t.key&&"ArrowRight"!==t.key)return;t.stopPropagation(),t.preventDefault();let x=(navigator.platform.match("Mac")?t.metaKey:t.ctrlKey)?e.nudgeStepLarge:t.shiftKey?e.nudgeStepMedium:e.nudgeStep,y=p(function(e,t,i,r){let n={...e};return"ArrowLeft"===t?"nw"===r?(n.x-=i,n.y-=i,n.width+=i,n.height+=i):"w"===r?(n.x-=i,n.width+=i):"sw"===r?(n.x-=i,n.width+=i,n.height+=i):"ne"===r?(n.y+=i,n.width-=i,n.height-=i):"e"===r?n.width-=i:"se"===r&&(n.width-=i,n.height-=i):"ArrowRight"===t&&("nw"===r?(n.x+=i,n.y+=i,n.width-=i,n.height-=i):"w"===r?(n.x+=i,n.width-=i):"sw"===r?(n.x+=i,n.width-=i,n.height-=i):"ne"===r?(n.y-=i,n.width+=i,n.height+=i):"e"===r?n.width+=i:"se"===r&&(n.width+=i,n.height+=i)),"ArrowUp"===t?"nw"===r?(n.x-=i,n.y-=i,n.width+=i,n.height+=i):"n"===r?(n.y-=i,n.height+=i):"ne"===r?(n.y-=i,n.width+=i,n.height+=i):"sw"===r?(n.x+=i,n.width-=i,n.height-=i):"s"===r?n.height-=i:"se"===r&&(n.width-=i,n.height-=i):"ArrowDown"===t&&("nw"===r?(n.x+=i,n.y+=i,n.width-=i,n.height-=i):"n"===r?(n.y+=i,n.height-=i):"ne"===r?(n.y+=i,n.width-=i,n.height-=i):"sw"===r?(n.x-=i,n.width+=i,n.height+=i):"s"===r?n.height+=i:"se"===r&&(n.width+=i,n.height+=i)),n}(w(n,m.width,m.height),t.key,x,i),r,i,m.width,m.height,o,h,s,d);if(!c(n,y)){let e=g(y,m.width,m.height);l(y,e),u&&u(y,e)}}),h(this,"onDocPointerDone",e=>{let{crop:t,disabled:i,onComplete:r,onDragEnd:n}=this.props,a=this.getBox();this.unbindDocMove(),!(i||!t)&&this.mouseDownOnCrop&&(this.mouseDownOnCrop=!1,this.dragStarted=!1,n&&n(e),r&&r(w(t,a.width,a.height),g(t,a.width,a.height)),this.setState({cropIsActive:!1,newCropIsBeingDrawn:!1}))}),h(this,"onDragFocus",()=>{var e;null==(e=this.componentRef.current)||e.scrollTo(0,0)})}get document(){return document}getBox(){let e=this.mediaRef.current;if(!e)return{x:0,y:0,width:0,height:0};let{x:t,y:i,width:r,height:n}=e.getBoundingClientRect();return{x:t,y:i,width:r,height:n}}componentDidUpdate(e){let{crop:t,onComplete:i}=this.props;if(i&&!e.crop&&t){let{width:e,height:r}=this.getBox();e&&r&&i(w(t,e,r),g(t,e,r))}}componentWillUnmount(){this.resizeObserver&&this.resizeObserver.disconnect(),this.unbindDocMove()}bindDocMove(){this.docMoveBound||(this.document.addEventListener("pointermove",this.onDocPointerMove,u),this.document.addEventListener("pointerup",this.onDocPointerDone,u),this.document.addEventListener("pointercancel",this.onDocPointerDone,u),this.docMoveBound=!0)}unbindDocMove(){this.docMoveBound&&(this.document.removeEventListener("pointermove",this.onDocPointerMove,u),this.document.removeEventListener("pointerup",this.onDocPointerDone,u),this.document.removeEventListener("pointercancel",this.onDocPointerDone,u),this.docMoveBound=!1)}getCropStyle(){let{crop:e}=this.props;if(e)return{top:`${e.y}${e.unit}`,left:`${e.x}${e.unit}`,width:`${e.width}${e.unit}`,height:`${e.height}${e.unit}`}}dragCrop(){let{evData:e}=this,t=this.getBox(),i=this.makePixelCrop(t),r=e.clientX-e.startClientX,n=e.clientY-e.startClientY;return i.x=d(e.startCropX+r,0,t.width-i.width),i.y=d(e.startCropY+n,0,t.height-i.height),i}getPointRegion(e,t,i,r){let n,a,{evData:o}=this,h=o.clientX-e.x,s=o.clientY-e.y;return n=r&&t?"nw"===t||"n"===t||"ne"===t:s<o.startCropY,(i&&t?"nw"===t||"w"===t||"sw"===t:h<o.startCropX)?n?"nw":"sw":n?"ne":"se"}resolveMinDimensions(e,t,i=0,r=0){let n=Math.min(i,e.width),a=Math.min(r,e.height);return t&&(n||a)?t>1?n?[n,n/t]:[a*t,a]:a?[a*t,a]:[n,n/t]:[n,a]}resizeCrop(){let{evData:t}=this,{aspect:i=0,maxWidth:r,maxHeight:n}=this.props,a=this.getBox(),[o,h]=this.resolveMinDimensions(a,i,this.props.minWidth,this.props.minHeight),s=this.makePixelCrop(a),l=this.getPointRegion(a,t.ord,o,h),c=t.ord||l,g=t.clientX-t.startClientX,w=t.clientY-t.startClientY;(o&&"nw"===c||"w"===c||"sw"===c)&&(g=Math.min(g,-o)),(h&&"nw"===c||"n"===c||"ne"===c)&&(w=Math.min(w,-h));let u={unit:"px",x:0,y:0,width:0,height:0};"ne"===l?(u.x=t.startCropX,u.width=g,i?u.height=u.width/i:u.height=Math.abs(w),u.y=t.startCropY-u.height):"se"===l?(u.x=t.startCropX,u.y=t.startCropY,u.width=g,i?u.height=u.width/i:u.height=w):"sw"===l?(u.x=t.startCropX+g,u.y=t.startCropY,u.width=Math.abs(g),i?u.height=u.width/i:u.height=w):"nw"===l&&(u.x=t.startCropX+g,u.width=Math.abs(g),i?(u.height=u.width/i,u.y=t.startCropY-u.height):(u.height=Math.abs(w),u.y=t.startCropY+w));let m=p(u,i,l,a.width,a.height,o,h,r,n);return i||e.xyOrds.indexOf(c)>-1?s=m:e.xOrds.indexOf(c)>-1?(s.x=m.x,s.width=m.width):e.yOrds.indexOf(c)>-1&&(s.y=m.y,s.height=m.height),s.x=d(s.x,0,a.width-s.width),s.y=d(s.y,0,a.height-s.height),s}renderCropSelection(){let{ariaLabels:t=e.defaultProps.ariaLabels,disabled:i,locked:r,renderSelectionAddon:a,ruleOfThirds:o,crop:h}=this.props,s=this.getCropStyle();if(h)return n.createElement("div",{style:s,className:"ReactCrop__crop-selection",onPointerDown:this.onCropPointerDown,"aria-label":t.cropArea,tabIndex:0,onKeyDown:this.onComponentKeyDown,role:"group"},!i&&!r&&n.createElement("div",{className:"ReactCrop__drag-elements",onFocus:this.onDragFocus},n.createElement("div",{className:"ReactCrop__drag-bar ord-n","data-ord":"n"}),n.createElement("div",{className:"ReactCrop__drag-bar ord-e","data-ord":"e"}),n.createElement("div",{className:"ReactCrop__drag-bar ord-s","data-ord":"s"}),n.createElement("div",{className:"ReactCrop__drag-bar ord-w","data-ord":"w"}),n.createElement("div",{className:"ReactCrop__drag-handle ord-nw","data-ord":"nw",tabIndex:0,"aria-label":t.nwDragHandle,onKeyDown:e=>this.onHandlerKeyDown(e,"nw"),role:"button"}),n.createElement("div",{className:"ReactCrop__drag-handle ord-n","data-ord":"n",tabIndex:0,"aria-label":t.nDragHandle,onKeyDown:e=>this.onHandlerKeyDown(e,"n"),role:"button"}),n.createElement("div",{className:"ReactCrop__drag-handle ord-ne","data-ord":"ne",tabIndex:0,"aria-label":t.neDragHandle,onKeyDown:e=>this.onHandlerKeyDown(e,"ne"),role:"button"}),n.createElement("div",{className:"ReactCrop__drag-handle ord-e","data-ord":"e",tabIndex:0,"aria-label":t.eDragHandle,onKeyDown:e=>this.onHandlerKeyDown(e,"e"),role:"button"}),n.createElement("div",{className:"ReactCrop__drag-handle ord-se","data-ord":"se",tabIndex:0,"aria-label":t.seDragHandle,onKeyDown:e=>this.onHandlerKeyDown(e,"se"),role:"button"}),n.createElement("div",{className:"ReactCrop__drag-handle ord-s","data-ord":"s",tabIndex:0,"aria-label":t.sDragHandle,onKeyDown:e=>this.onHandlerKeyDown(e,"s"),role:"button"}),n.createElement("div",{className:"ReactCrop__drag-handle ord-sw","data-ord":"sw",tabIndex:0,"aria-label":t.swDragHandle,onKeyDown:e=>this.onHandlerKeyDown(e,"sw"),role:"button"}),n.createElement("div",{className:"ReactCrop__drag-handle ord-w","data-ord":"w",tabIndex:0,"aria-label":t.wDragHandle,onKeyDown:e=>this.onHandlerKeyDown(e,"w"),role:"button"})),a&&n.createElement("div",{className:"ReactCrop__selection-addon",onPointerDown:e=>e.stopPropagation()},a(this.state)),o&&n.createElement(n.Fragment,null,n.createElement("div",{className:"ReactCrop__rule-of-thirds-hz"}),n.createElement("div",{className:"ReactCrop__rule-of-thirds-vt"})))}makePixelCrop(e){return w({...s,...this.props.crop||{}},e.width,e.height)}render(){let{aspect:e,children:t,circularCrop:i,className:r,crop:a,disabled:o,locked:h,style:s,ruleOfThirds:d}=this.props,{cropIsActive:c,newCropIsBeingDrawn:g}=this.state,w=a?this.renderCropSelection():null,p=l("ReactCrop",r,c&&"ReactCrop--active",o&&"ReactCrop--disabled",h&&"ReactCrop--locked",g&&"ReactCrop--new-crop",a&&e&&"ReactCrop--fixed-aspect",a&&i&&"ReactCrop--circular-crop",a&&d&&"ReactCrop--rule-of-thirds",!this.dragStarted&&a&&!a.width&&!a.height&&"ReactCrop--invisible-crop",i&&"ReactCrop--no-animate");return n.createElement("div",{ref:this.componentRef,className:p,style:s},n.createElement("div",{ref:this.mediaRef,className:"ReactCrop__child-wrapper",onPointerDown:this.onComponentPointerDown},t),a?n.createElement("svg",{className:"ReactCrop__crop-mask",width:"100%",height:"100%"},n.createElement("defs",null,n.createElement("mask",{id:`hole-${this.instanceId}`},n.createElement("rect",{width:"100%",height:"100%",fill:"white"}),i?n.createElement("ellipse",{cx:`${a.x+a.width/2}${a.unit}`,cy:`${a.y+a.height/2}${a.unit}`,rx:`${a.width/2}${a.unit}`,ry:`${a.height/2}${a.unit}`,fill:"black"}):n.createElement("rect",{x:`${a.x}${a.unit}`,y:`${a.y}${a.unit}`,width:`${a.width}${a.unit}`,height:`${a.height}${a.unit}`,fill:"black"}))),n.createElement("rect",{fill:"black",fillOpacity:.5,width:"100%",height:"100%",mask:`url(#hole-${this.instanceId})`})):void 0,w)}};function y(){let[e,t]=(0,n.useState)(""),i=(0,n.useRef)(null),a=(0,n.useRef)(null),[o,h]=(0,n.useState)(),[s,d]=(0,n.useState)(),[l,c]=(0,n.useState)(1),[p,u]=(0,n.useState)(0),[m,y]=(0,n.useState)(void 0);async function v(){try{let t=a.current,r=i.current;if(!t||!r||!s)throw Error("Crop canvas does not exist");let n=t.naturalWidth/t.width,o=t.naturalHeight/t.height,h=s.x*n,d=s.y*o,l=s.width*n,c=s.height*o,g=document.createElement("canvas");g.width=l,g.height=c;let w=g.getContext("2d");if(!w)throw Error("Could not get canvas context");w.drawImage(t,h,d,l,c,0,0,l,c);let p=g.width,u=g.height;if(p>1024){var e;let t=1024/p;p=1024,u*=t;let i=document.createElement("canvas");i.width=p,i.height=u;let r=i.getContext("2d");if(!r)throw Error("Could not get resized canvas context");r.drawImage(g,0,0,g.width,g.height,0,0,p,u),g.width=p,g.height=u,null==(e=g.getContext("2d"))||e.drawImage(i,0,0)}return new Promise((e,t)=>{g.toBlob(i=>{if(!i)return void t(Error("Canvas to Blob conversion failed"));if(i.size>4718592){alert("Image is too large after resizing. Try reducing quality or cropping a smaller area."),t(Error("Image too large"));return}let r=new FileReader;r.onloadend=()=>{try{let t=r.result;localStorage.setItem("savedImage",t),alert("Image saved successfully! Go to lightbox tab below to use."),e(!0)}catch(e){console.error("LocalStorage error:",e),alert("Failed to save image to storage."),t(e)}},r.onerror=()=>t(Error("FileReader error")),r.readAsDataURL(i)},"image/jpeg",.8)})}catch(e){return console.error("Error in saveImage:",e),alert("Failed to save image: "),!1}}return(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{className:"App",children:[(0,r.jsxs)("div",{className:"Crop-Controls",style:{justifyContent:"center",marginTop:"50px",marginBottom:"50px"},children:[(0,r.jsx)("p",{children:"Select an image to use for reference"}),(0,r.jsx)("input",{type:"file",accept:"image/*",onChange:function(e){if(e.target.files&&e.target.files.length>0){h(void 0);let i=new FileReader;i.addEventListener("load",()=>{var e;return t((null==(e=i.result)?void 0:e.toString())||"")}),i.readAsDataURL(e.target.files[0])}}})]}),!!e&&(0,r.jsx)("div",{className:"cropSection",children:(0,r.jsx)(x,{crop:o,onChange:(e,t)=>h(t),onComplete:e=>d(e),aspect:m,minHeight:50,children:(0,r.jsx)("img",{ref:a,alt:"Crop me",src:e,style:{transform:"scale(".concat(l,") rotate(").concat(p,"deg)")},onLoad:function(e){let{width:t,height:i}=e.currentTarget;h(function(e,t,i){var r=function(e,t,i,r){let n=w(e,i,r);return e.width&&(n.height=n.width/1),e.height&&(n.width=n.height*t),n.y+n.height>r&&(n.height=r-n.y,n.width=n.height*t),n.x+n.width>i&&(n.width=i-n.x,n.height=n.width/t),"%"===e.unit?g(n,i,r):n}({unit:"%",height:40},1,e,t);let n=w(r,e,t);return n.x=(e-n.width)/2,n.y=(t-n.height)/2,"%"===r.unit?g(n,e,t):n}(t,i,0))}})})}),!!s&&(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"Crop-Controls",children:(0,r.jsx)("button",{onClick:v,children:"Save Image"})}),(0,r.jsx)("canvas",{ref:i,style:{border:"1px solid black",objectFit:"contain",width:s.width,height:s.height,visibility:"hidden"}})]})})]})})}h(x,"xOrds",["e","w"]),h(x,"yOrds",["n","s"]),h(x,"xyOrds",["nw","ne","se","sw"]),h(x,"nudgeStep",1),h(x,"nudgeStepMedium",10),h(x,"nudgeStepLarge",100),h(x,"defaultProps",{ariaLabels:{cropArea:"Use the arrow keys to move the crop selection area",nwDragHandle:"Use the arrow keys to move the north west drag handle to change the crop selection area",nDragHandle:"Use the up and down arrow keys to move the north drag handle to change the crop selection area",neDragHandle:"Use the arrow keys to move the north east drag handle to change the crop selection area",eDragHandle:"Use the up and down arrow keys to move the east drag handle to change the crop selection area",seDragHandle:"Use the arrow keys to move the south east drag handle to change the crop selection area",sDragHandle:"Use the up and down arrow keys to move the south drag handle to change the crop selection area",swDragHandle:"Use the arrow keys to move the south west drag handle to change the crop selection area",wDragHandle:"Use the up and down arrow keys to move the west drag handle to change the crop selection area"}}),i(4534)},9801:(e,t,i)=>{Promise.resolve().then(i.bind(i,7842))}},e=>{var t=t=>e(e.s=t);e.O(0,[111,441,684,358],()=>t(9801)),_N_E=e.O()}]);